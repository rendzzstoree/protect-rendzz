#!/bin/bash

echo "ğŸ¨ Installing Premium iOS Glass Theme..."

PANEL_PATH="/var/www/pterodactyl"
BASE_TEMPLATE="$PANEL_PATH/resources/views/templates/base/core.blade.php"
AUTH_LAYOUT="$PANEL_PATH/resources/views/layouts/auth.blade.php"
APP_LAYOUT="$PANEL_PATH/resources/views/layouts/app.blade.php"
TIMESTAMP=$(date -u +"%Y-%m-%d-%H-%M-%S")

# Background & Icon URLs
BG_IMAGE="https://files.catbox.moe/z32ox4.jpg"
ICON_IMAGE="https://files.catbox.moe/s5j9uq.jpg"

# ===== BACKUP =====
cp "$BASE_TEMPLATE" "${BASE_TEMPLATE}.bak_${TIMESTAMP}"
cp "$AUTH_LAYOUT" "${AUTH_LAYOUT}.bak_${TIMESTAMP}"
cp "$APP_LAYOUT" "${APP_LAYOUT}.bak_${TIMESTAMP}"
echo "ğŸ“¦ Backup semua file OK"

# ===== 1. UPDATE BASE TEMPLATE (PREMIUM iOS GLASS THEME) =====
cat > "$BASE_TEMPLATE" << 'EOF'
@extends('templates/wrapper', [
    'css' => ['body' => 'bg-neutral-900'],
])

@section('container')
    <div id="modal-portal"></div>
    <div id="app"></div>

    <!-- Premium iOS Glass Theme CSS -->
    <style>
    /* ===== PREMIUM iOS GLASS THEME - RENSTR EDITION ===== */
    :root {
      --glass-bg: linear-gradient(135deg, rgba(0,0,0,0.95) 0%, rgba(20,20,30,0.98) 100%);
      --glass-card: rgba(255, 255, 255, 0.08);
      --glass-card-hover: rgba(255, 255, 255, 0.12);
      --glass-border: rgba(255, 255, 255, 0.1);
      --glass-border-glow: rgba(255, 255, 255, 0.2);
      --glass-glow: 0 0 60px rgba(10, 132, 255, 0.2);
      --ios-blue: linear-gradient(135deg, #0a84ff, #007aff);
      --ios-purple: linear-gradient(135deg, #bf5af2, #9c3dd4);
      --ios-green: linear-gradient(135deg, #30d158, #25c748);
      --ios-red: linear-gradient(135deg, #ff375f, #ff2d55);
      --text-primary: rgba(255, 255, 255, 0.95);
      --text-secondary: rgba(255, 255, 255, 0.7);
      --text-tertiary: rgba(255, 255, 255, 0.5);
    }

    /* Main Background - Ultra Premium */
    body {
      background: var(--glass-bg), url('https://files.catbox.moe/z32ox4.jpg') !important;
      background-size: cover !important;
      background-position: center !important;
      background-attachment: fixed !important;
      background-repeat: no-repeat !important;
      color: var(--text-primary) !important;
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', 'Segoe UI', Roboto, sans-serif !important;
      font-weight: 300 !important;
      letter-spacing: 0.3px !important;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }

    /* Ultra Premium Glass Effect Background */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 15% 15%, rgba(10, 132, 255, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 85% 85%, rgba(191, 90, 242, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 50% 50%, rgba(255, 55, 95, 0.08) 0%, transparent 60%),
        linear-gradient(45deg, rgba(0,0,0,0.7) 0%, transparent 50%);
      backdrop-filter: blur(100px) saturate(200%);
      -webkit-backdrop-filter: blur(100px) saturate(200%);
      z-index: -1;
      pointer-events: none;
    }

    /* Premium Glass Cards */
    .bg-white, .bg-gray-100, .card, .panel, .dashboard-card, 
    .bg-gray-800, .bg-gray-900, [class*="bg-"] {
      background: var(--glass-card) !important;
      backdrop-filter: blur(30px) saturate(180%) !important;
      -webkit-backdrop-filter: blur(30px) saturate(180%) !important;
      border: 1px solid var(--glass-border) !important;
      border-radius: 24px !important;
      color: var(--text-primary) !important;
      box-shadow: 
        0 20px 60px rgba(0,0,0,0.4),
        var(--glass-glow),
        inset 0 1px 0 rgba(255,255,255,0.1) !important;
      margin-bottom: 2rem !important;
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1) !important;
      overflow: hidden !important;
      position: relative !important;
    }

    /* Ultra Premium Card Hover Effect */
    .bg-white:hover, .bg-gray-100:hover, .card:hover, .panel:hover {
      background: var(--glass-card-hover) !important;
      transform: translateY(-8px) scale(1.02) !important;
      border-color: var(--glass-border-glow) !important;
      box-shadow: 
        0 30px 80px rgba(0,0,0,0.6),
        0 0 100px rgba(10, 132, 255, 0.3),
        inset 0 1px 0 rgba(255,255,255,0.2) !important;
    }

    /* Premium Glass Card Inner Glow */
    .bg-white::before, .bg-gray-100::before, .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, 
        transparent, 
        rgba(255,255,255,0.3), 
        transparent
      );
      z-index: 1;
    }

    /* Ultra Premium iOS Buttons */
    button, .btn, [type="submit"], a.btn {
      background: var(--ios-blue) !important;
      color: white !important;
      border: none !important;
      border-radius: 18px !important;
      padding: 18px 32px !important;
      font-size: 18px !important;
      font-weight: 600 !important;
      letter-spacing: 0.5px !important;
      cursor: pointer !important;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
      position: relative;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(10, 132, 255, 0.3) !important;
      text-transform: uppercase !important;
      font-family: 'SF Pro Display', -apple-system, sans-serif !important;
    }

    /* Button Hover Effects */
    button:hover, .btn:hover, [type="submit"]:hover {
      background: linear-gradient(135deg, #007aff, #0056d6) !important;
      transform: translateY(-4px) scale(1.05) !important;
      box-shadow: 
        0 20px 50px rgba(10, 132, 255, 0.5),
        0 0 60px rgba(10, 132, 255, 0.3) !important;
      letter-spacing: 1px !important;
    }

    /* Button Active/Pressed Effect */
    button:active, .btn:active {
      transform: translateY(-2px) scale(0.98) !important;
      transition: all 0.1s ease !important;
    }

    /* Ultra Premium Input Fields */
    input, select, textarea, .form-input, .form-select {
      background: rgba(255, 255, 255, 0.05) !important;
      backdrop-filter: blur(20px) !important;
      border: 2px solid var(--glass-border) !important;
      border-radius: 16px !important;
      color: var(--text-primary) !important;
      padding: 16px 20px !important;
      font-size: 17px !important;
      font-weight: 400 !important;
      font-family: 'SF Pro Text', -apple-system, sans-serif !important;
      transition: all 0.3s ease !important;
      box-shadow: inset 0 2px 10px rgba(0,0,0,0.2) !important;
    }

    /* Input Focus Effect */
    input:focus, select:focus, textarea:focus {
      background: rgba(255, 255, 255, 0.08) !important;
      border-color: #0a84ff !important;
      box-shadow: 
        inset 0 2px 10px rgba(0,0,0,0.3),
        0 0 0 4px rgba(10, 132, 255, 0.2) !important;
      outline: none !important;
      transform: translateY(-2px) !important;
    }

    /* Premium Header */
    header, .navbar, .bg-gray-800 {
      background: rgba(0, 0, 0, 0.4) !important;
      backdrop-filter: blur(40px) saturate(200%) !important;
      -webkit-backdrop-filter: blur(40px) saturate(200%) !important;
      border-bottom: 1px solid var(--glass-border) !important;
      box-shadow: 
        0 10px 30px rgba(0,0,0,0.3),
        0 1px 0 rgba(255,255,255,0.05) !important;
      padding: 1rem 0 !important;
    }

    /* Status Indicators - Premium Glow */
    .bg-success, .status-online, .badge-success {
      background: var(--ios-green) !important;
      color: white !important;
      box-shadow: 0 0 20px rgba(48, 209, 88, 0.4) !important;
      animation: successGlow 2s infinite alternate !important;
    }
    
    .bg-danger, .status-offline, .badge-danger {
      background: var(--ios-red) !important;
      color: white !important;
      box-shadow: 0 0 20px rgba(255, 55, 95, 0.4) !important;
      animation: dangerGlow 2s infinite alternate !important;
    }
    
    .bg-primary, .status-active, .badge-primary {
      background: var(--ios-blue) !important;
      color: white !important;
      box-shadow: 0 0 20px rgba(10, 132, 255, 0.4) !important;
      animation: primaryGlow 2s infinite alternate !important;
    }
    
    .bg-warning, .badge-warning {
      background: linear-gradient(135deg, #ff9f0a, #ff8a00) !important;
      color: white !important;
      box-shadow: 0 0 20px rgba(255, 159, 10, 0.4) !important;
    }

    @keyframes successGlow {
      from { box-shadow: 0 0 20px rgba(48, 209, 88, 0.4); }
      to { box-shadow: 0 0 40px rgba(48, 209, 88, 0.6); }
    }
    
    @keyframes dangerGlow {
      from { box-shadow: 0 0 20px rgba(255, 55, 95, 0.4); }
      to { box-shadow: 0 0 40px rgba(255, 55, 95, 0.6); }
    }
    
    @keyframes primaryGlow {
      from { box-shadow: 0 0 20px rgba(10, 132, 255, 0.4); }
      to { box-shadow: 0 0 40px rgba(10, 132, 255, 0.6); }
    }

    /* Ultra Premium Scrollbar */
    ::-webkit-scrollbar { 
      width: 12px; 
      height: 12px; 
      background: transparent !important;
    }
    
    ::-webkit-scrollbar-track { 
      background: rgba(0,0,0,0.2) !important;
      backdrop-filter: blur(10px) !important;
      border-radius: 20px !important;
      margin: 10px !important;
    }
    
    ::-webkit-scrollbar-thumb { 
      background: linear-gradient(135deg, #0a84ff, #bf5af2) !important;
      border-radius: 20px !important;
      border: 3px solid rgba(0,0,0,0.2) !important;
      box-shadow: inset 0 0 10px rgba(255,255,255,0.2) !important;
      transition: all 0.3s ease !important;
    }
    
    ::-webkit-scrollbar-thumb:hover { 
      background: linear-gradient(135deg, #007aff, #9c3dd4) !important;
      transform: scale(1.1) !important;
    }

    /* Premium Table Styling */
    table {
      background: rgba(255, 255, 255, 0.03) !important;
      backdrop-filter: blur(30px) !important;
      border-radius: 20px !important;
      overflow: hidden !important;
      border: 1px solid var(--glass-border) !important;
      border-spacing: 0 !important;
    }

    th {
      background: rgba(255, 255, 255, 0.1) !important;
      color: var(--text-primary) !important;
      font-weight: 600 !important;
      padding: 20px !important;
      border-bottom: 2px solid var(--glass-border) !important;
      text-transform: uppercase !important;
      letter-spacing: 1px !important;
      font-size: 14px !important;
    }

    td {
      padding: 18px 20px !important;
      border-bottom: 1px solid rgba(255,255,255,0.05) !important;
      color: var(--text-secondary) !important;
      transition: all 0.3s ease !important;
    }

    tr:hover td {
      background: rgba(10, 132, 255, 0.08) !important;
      color: var(--text-primary) !important;
      transform: translateX(5px) !important;
    }

    /* Premium Sidebar Navigation */
    nav, aside, .sidebar {
      background: rgba(0, 0, 0, 0.3) !important;
      backdrop-filter: blur(40px) saturate(200%) !important;
      border-right: 1px solid var(--glass-border) !important;
      padding: 2rem 1rem !important;
    }

    nav a, aside a, .sidebar a {
      color: var(--text-secondary) !important;
      border-radius: 16px !important;
      margin: 8px 0 !important;
      padding: 16px 20px !important;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
      display: flex !important;
      align-items: center !important;
      gap: 15px !important;
      font-weight: 500 !important;
      font-size: 16px !important;
      position: relative !important;
      overflow: hidden !important;
    }

    nav a:hover, aside a:hover {
      background: rgba(10, 132, 255, 0.2) !important;
      color: var(--text-primary) !important;
      transform: translateX(10px) !important;
      box-shadow: 0 10px 30px rgba(10, 132, 255, 0.2) !important;
    }

    nav a.active, aside a.active {
      background: linear-gradient(90deg, 
        rgba(10, 132, 255, 0.3), 
        rgba(10, 132, 255, 0.15)
      ) !important;
      color: white !important;
      border-left: 4px solid #0a84ff !important;
    }

    /* Premium Footer */
    footer, .footer {
      background: rgba(0, 0, 0, 0.5) !important;
      backdrop-filter: blur(40px) !important;
      border-top: 1px solid var(--glass-border) !important;
      padding: 2rem 0 !important;
      margin-top: 4rem !important;
    }

    /* Custom Footer Text - Premium Branding */
    .text-center.text-xs.text-gray-500 {
      font-size: 0 !important;
    }
    
    .text-center.text-xs.text-gray-500::after {
      content: "ğŸ…â€¯ğŸ„´â€¯ğŸ„½â€¯ğŸ…‚â€¯ğŸ…ƒâ€¯ğŸ…â€¯â€¯â€¢â€¯â€¯ğŸ„¿â€¯ğŸ…â€¯ğŸ„´â€¯ğŸ„¼â€¯ğŸ„¸â€¯ğŸ…„â€¯ğŸ„¼â€¯â€¯ğŸ„¸â€¯ğŸ„¾â€¯ğŸ…‚â€¯â€¯ğŸ…ƒâ€¯ğŸ„·â€¯ğŸ„´â€¯ğŸ„¼â€¯ğŸ„´";
      font-size: 14px !important;
      color: var(--text-tertiary) !important;
      letter-spacing: 2px !important;
      font-weight: 300 !important;
      font-family: 'SF Pro Display', -apple-system, sans-serif !important;
      text-transform: uppercase !important;
    }

    /* Premium Server Status Dots */
    .status-dot::before {
      content: 'â—';
      font-size: 14px;
      margin-right: 10px;
      animation: premiumPulse 1.5s infinite ease-in-out;
      text-shadow: 0 0 10px currentColor;
    }
    
    @keyframes premiumPulse {
      0%, 100% { 
        opacity: 0.6; 
        transform: scale(0.9); 
      }
      50% { 
        opacity: 1; 
        transform: scale(1.1); 
      }
    }

    /* Premium Loading Spinner */
    .spinner, .loading-spinner {
      border: 4px solid rgba(10, 132, 255, 0.1);
      border-top: 4px solid #0a84ff;
      border-right: 4px solid #bf5af2;
      border-bottom: 4px solid #30d158;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: premiumSpin 1.5s linear infinite;
      box-shadow: 0 0 30px rgba(10, 132, 255, 0.3);
    }
    
    @keyframes premiumSpin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Premium Notification Badges */
    .badge, .label, .tag {
      background: var(--ios-blue) !important;
      border-radius: 20px !important;
      padding: 8px 16px !important;
      font-size: 13px !important;
      font-weight: 700 !important;
      letter-spacing: 1px !important;
      box-shadow: 0 5px 20px rgba(10, 132, 255, 0.3) !important;
      animation: badgeFloat 3s infinite ease-in-out !important;
      text-transform: uppercase !important;
    }
    
    @keyframes badgeFloat {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }

    /* Premium Progress Bars */
    .progress {
      background: rgba(255, 255, 255, 0.05) !important;
      border-radius: 15px !important;
      height: 12px !important;
      overflow: hidden !important;
      box-shadow: inset 0 2px 10px rgba(0,0,0,0.3) !important;
    }

    .progress-bar {
      background: linear-gradient(90deg, 
        #0a84ff, 
        #bf5af2, 
        #ff375f
      ) !important;
      border-radius: 15px !important;
      transition: width 1.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
      position: relative !important;
      overflow: hidden !important;
    }

    .progress-bar::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, 
        transparent, 
        rgba(255,255,255,0.4), 
        transparent
      );
      animation: shimmer 2s infinite;
    }
    
    @keyframes shimmer {
      100% { left: 100%; }
    }

    /* Premium Modal/Dialog */
    .modal-content, .dialog, [role="dialog"] {
      background: rgba(0, 0, 0, 0.7) !important;
      backdrop-filter: blur(50px) saturate(200%) !important;
      border: 1px solid var(--glass-border) !important;
      border-radius: 30px !important;
      box-shadow: 
        0 40px 100px rgba(0,0,0,0.6),
        0 0 120px rgba(10, 132, 255, 0.2) !important;
      padding: 3rem !important;
    }

    /* EXCLUDE FILE MANAGER AREAS */
    #file-manager, 
    .file-manager,
    [data-file-manager],
    #fm-wrapper,
    .filemanager-wrapper {
      background: transparent !important;
      backdrop-filter: none !important;
      border: none !important;
      box-shadow: none !important;
      border-radius: 0 !important;
    }
    
    /* Keep file manager buttons normal */
    #file-manager button,
    .file-manager .btn,
    [data-file-manager] button {
      background: #3498db !important;
      border-radius: 6px !important;
      padding: 8px 16px !important;
      font-size: 14px !important;
      box-shadow: none !important;
      transform: none !important;
    }
    
    /* Keep file manager inputs normal */
    #file-manager input,
    .file-manager input {
      background: white !important;
      color: black !important;
      border: 1px solid #ddd !important;
      border-radius: 4px !important;
      padding: 8px !important;
      font-size: 14px !important;
    }
    
    /* Keep file manager tables normal */
    #file-manager table,
    .file-manager table {
      background: white !important;
      color: black !important;
      border: 1px solid #ddd !important;
      border-radius: 4px !important;
    }
    </style>

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- SF Pro Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700;800&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=SF+Pro+Text:wght@300;400;500;600;700&display=swap">
    
    <!-- Material Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@7.2.96/css/materialdesignicons.min.css">

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const username = @json(auth()->user()->name?? 'User');
        
        // Ultra Premium Welcome Message
        const welcomeDiv = document.createElement("div");
        welcomeDiv.innerHTML = `
          <div style="
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 25px;
            background: linear-gradient(135deg, 
              rgba(10, 132, 255, 0.15), 
              rgba(191, 90, 242, 0.15)
            );
            backdrop-filter: blur(40px);
            border-radius: 30px;
            border: 2px solid rgba(255, 255, 255, 0.15);
            box-shadow: 
              0 30px 80px rgba(0,0,0,0.5),
              0 0 100px rgba(10, 132, 255, 0.2);
            position: relative;
            overflow: hidden;
          ">
            <div style="
              width: 70px;
              height: 70px;
              background: url('https://files.catbox.moe/s5j9uq.jpg') center/cover;
              border-radius: 20px;
              border: 3px solid rgba(255, 255, 255, 0.3);
              box-shadow: 0 10px 30px rgba(0,0,0,0.4);
            "></div>
            <div>
              <div style="
                font-size: 24px;
                font-weight: 800;
                background: linear-gradient(135deg, #0a84ff, #bf5af2, #ff375f);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                margin-bottom: 5px;
                letter-spacing: 1px;
              ">
                ğ—ªğ—˜ğ—Ÿğ—–ğ—¢ğ— ğ—˜, ${username.toUpperCase()}! ğŸ‘‘
              </div>
              <div style="
                font-size: 14px;
                color: rgba(255,255,255,0.8);
                letter-spacing: 3px;
                text-transform: uppercase;
              ">
                ğŸ…â€¯ğŸ„´â€¯ğŸ„½â€¯ğŸ…‚â€¯ğŸ…ƒâ€¯ğŸ…â€¯â€¯â€¢â€¯â€¯ğŸ„¿â€¯ğŸ…â€¯ğŸ„´â€¯ğŸ„¼â€¯ğŸ„¸â€¯ğŸ…„â€¯ğŸ„¼â€¯â€¯ğŸ„´â€¯ğŸ„³â€¯ğŸ„¸â€¯ğŸ…ƒâ€¯ğŸ„¸â€¯ğŸ„¾â€¯ğŸ„½
              </div>
            </div>
            <div style="
              position: absolute;
              top: 0;
              right: 0;
              padding: 10px 20px;
              background: rgba(10, 132, 255, 0.3);
              border-bottom-left-radius: 20px;
              font-size: 12px;
              letter-spacing: 2px;
            ">
              ğŸš€ VIP
            </div>
          </div>
        `;
        
        Object.assign(welcomeDiv.style, {
          position: "fixed",
          top: "30px",
          right: "30px",
          zIndex: "99999",
          opacity: "0",
          transform: "translateX(100px) scale(0.8)",
          transition: "all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1)",
          maxWidth: "450px",
          cursor: "pointer",
        });

        document.body.appendChild(welcomeDiv);
        
        // Animate in
        setTimeout(() => {
          welcomeDiv.style.opacity = "1";
          welcomeDiv.style.transform = "translateX(0) scale(1)";
        }, 500);
        
        // Auto-hide after 8 seconds
        setTimeout(() => {
          welcomeDiv.style.opacity = "0";
          welcomeDiv.style.transform = "translateX(100px) scale(0.8)";
        }, 8000);
        
        setTimeout(() => welcomeDiv.remove(), 9000);

        // Click to dismiss
        welcomeDiv.addEventListener("click", () => {
          welcomeDiv.style.opacity = "0";
          welcomeDiv.style.transform = "translateX(100px) scale(0.8)";
          setTimeout(() => welcomeDiv.remove(), 500);
        });

        // Replace Pterodactyl Logo
        setTimeout(() => {
          const logos = document.querySelectorAll('img[src*="logo"], img[alt*="Pterodactyl"], img[alt*="Logo"]');
          logos.forEach(logo => {
            logo.src = 'https://files.catbox.moe/s5j9uq.jpg';
            logo.style.borderRadius = '15px';
            logo.style.boxShadow = '0 10px 30px rgba(0,0,0,0.3)';
            logo.style.border = '3px solid rgba(255,255,255,0.1)';
          });
        }, 1000);
      });
    </script>
@endsection
EOF

echo "âœ… Premium iOS Glass Theme installed!"

# ===== 2. UPDATE AUTH LAYOUT (LOGIN PAGE) =====
AUTH_CSS="<style>
/* Ultra Premium Login Page */
#app > div {
  background: linear-gradient(rgba(0,0,0,0.95), rgba(0,0,0,0.9)), url('${BG_IMAGE}') !important;
  background-size: cover !important;
  background-position: center !important;
  background-attachment: fixed !important;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  overflow: hidden;
}

/* Premium Login Glass Effect */
#app > div::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  right: -50%;
  bottom: -50%;
  background: 
    radial-gradient(circle at 20% 20%, rgba(10, 132, 255, 0.25) 0%, transparent 50%),
    radial-gradient(circle at 80% 80%, rgba(191, 90, 242, 0.25) 0%, transparent 50%),
    radial-gradient(circle at 50% 50%, rgba(255, 55, 95, 0.15) 0%, transparent 60%);
  backdrop-filter: blur(150px);
  animation: rotateBg 30s linear infinite;
  z-index: 0;
}

@keyframes rotateBg {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* Ultra Premium Login Card */
.bg-white, .bg-gray-100 {
  background: rgba(255, 255, 255, 0.05) !important;
  backdrop-filter: blur(60px) saturate(200%) !important;
  -webkit-backdrop-filter: blur(60px) saturate(200%) !important;
  border: 2px solid rgba(255, 255, 255, 0.1) !important;
  border-radius: 40px !important;
  padding: 4rem !important;
  max-width: 500px !important;
  width: 90% !important;
  box-shadow: 
    0 40px 100px rgba(0,0,0,0.6),
    0 0 150px rgba(10, 132, 255, 0.3),
    inset 0 1px 0 rgba(255,255,255,0.2) !important;
  position: relative;
  z-index: 1;
  margin: 2rem !important;
}

/* Premium Login Title */
.text-2xl, .text-3xl, h1, h2 {
  background: linear-gradient(135deg, 
    #0a84ff 0%, 
    #bf5af2 50%, 
    #ff375f 100%
  ) !important;
  -webkit-background-clip: text !important;
  -webkit-text-fill-color: transparent !important;
  background-size: 300% 300% !important;
  animation: gradientFlow 5s ease infinite !important;
  font-weight: 900 !important;
  font-size: 3rem !important;
  letter-spacing: -1px !important;
  text-align: center !important;
  margin-bottom: 3rem !important;
  font-family: 'SF Pro Display', sans-serif !important;
  text-transform: uppercase !important;
}

@keyframes gradientFlow {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

/* Premium Login Button */
button[type=\"submit\"] {
  width: 100% !important;
  margin-top: 2.5rem !important;
  font-size: 20px !important;
  padding: 22px !important;
  border-radius: 20px !important;
  letter-spacing: 2px !important;
  text-transform: uppercase !important;
  font-weight: 800 !important;
}

/* Premium Login Footer */
.text-center.text-xs.text-gray-500::after {
  content: 'ğŸ…â€¯ğŸ„´â€¯ğŸ„½â€¯ğŸ…‚â€¯ğŸ…ƒâ€¯ğŸ…â€¯â€¯â€¢â€¯â€¯ğŸ„¿â€¯ğŸ…â€¯ğŸ„´â€¯ğŸ„¼â€¯ğŸ„¸â€¯ğŸ…„â€¯ğŸ„¼â€¯â€¯ğŸ„¸â€¯ğŸ„¾â€¯ğŸ…‚â€¯â€¯ğŸ…ƒâ€¯ğŸ„·â€¯ğŸ„´â€¯ğŸ„¼â€¯ğŸ„´';
  color: rgba(255, 255, 255, 0.4) !important;
  font-size: 13px !important;
  letter-spacing: 3px !important;
  font-family: 'SF Pro Text', sans-serif !important;
  text-transform: uppercase !important;
  margin-top: 3rem !important;
  display: block !important;
}
</style>"

# Insert CSS at the end of head
if grep -q "</head>" "$AUTH_LAYOUT"; then
    sed -i "/<\/head>/i $AUTH_CSS" "$AUTH_LAYOUT"
else
    echo "$AUTH_CSS" >> "$AUTH_LAYOUT"
fi

# ===== 3. ADD PREMIUM FONTS =====
FONT_LINK='<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700;800;900&family=SF+Pro+Text:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">'

# Add fonts to both layouts
for layout in "$AUTH_LAYOUT" "$APP_LAYOUT"; do
    if grep -q "</head>" "$layout"; then
        sed -i "/<\/head>/i $FONT_LINK" "$layout"
    else
        echo "$FONT_LINK" >> "$layout"
    fi
done

# ===== 4. PERMISSIONS =====
chown -R www-data:www-data "$PANEL_PATH"

# ===== 5. CLEAR CACHE =====
cd "$PANEL_PATH" || exit
php artisan view:clear
php artisan cache:clear
php artisan config:clear
php artisan route:clear

echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘                    ğŸ‰ INSTALLATION COMPLETE!                  â•‘"
echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
echo "â•‘                                                              â•‘"
echo "â•‘  âœ¨ ULTRA PREMIUM FEATURES:                                  â•‘"
echo "â•‘     â€¢ Premium iOS Glass Morphism Design                     â•‘"
echo "â•‘     â€¢ Custom Icon: ${ICON_IMAGE:0:40}... â•‘"
echo "â•‘     â€¢ Ultra Smooth Animations & Transitions                 â•‘"
echo "â•‘     â€¢ Premium Gradients & Glow Effects                      â•‘"
echo "â•‘     â€¢ SF Pro Display Fonts                                  â•‘"
echo "â•‘     â€¢ VIP Welcome Message                                   â•‘"
echo "â•‘     â€¢ File Manager PROTECTED (Not Affected)                 â•‘"
echo "â•‘     â€¢ Premium Branding: RENSTR â€¢ PREMIUM iOS THEME          â•‘"
echo "â•‘                                                              â•‘"
echo "â•‘  ğŸš€ YOUR PANEL IS NOW ULTRA PREMIUM!                        â•‘"
echo "â•‘                                                              â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸ”„ Please refresh your browser to see the premium changes!"
echo ""
