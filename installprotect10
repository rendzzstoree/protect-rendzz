#!/bin/bash

echo "ðŸŽ¨ Updating RENDZZ Official Theme with Custom Dashboard..."

PANEL_PATH="/var/www/pterodactyl"
BASE_TEMPLATE="$PANEL_PATH/resources/views/templates/base/core.blade.php"
AUTH_LAYOUT="$PANEL_PATH/resources/views/layouts/auth.blade.php"
APP_LAYOUT="$PANEL_PATH/resources/views/layouts/app.blade.php"
ADMIN_LAYOUT="$PANEL_PATH/resources/views/layouts/admin.blade.php"
TIMESTAMP=$(date -u +"%Y-%m-%d-%H-%M-%S")

# Background Image URL
BG_IMAGE="https://files.catbox.moe/z32ox4.jpg"

# ===== BACKUP =====
cp "$BASE_TEMPLATE" "${BASE_TEMPLATE}.bak_${TIMESTAMP}"
cp "$AUTH_LAYOUT" "${AUTH_LAYOUT}.bak_${TIMESTAMP}"
cp "$APP_LAYOUT" "${APP_LAYOUT}.bak_${TIMESTAMP}"
cp "$ADMIN_LAYOUT" "${ADMIN_LAYOUT}.bak_${TIMESTAMP}"
echo "ðŸ“¦ Backup semua file OK"

# ===== 1. UPDATE BASE TEMPLATE (RENDZZ THEME) =====
cat > "$BASE_TEMPLATE" << 'EOF'
@extends('templates/wrapper', [
    'css' => ['body' => 'bg-neutral-800'],
])

@section('container')
    <div id="modal-portal"></div>
    <div id="app"></div>

    <!-- RENDZZ Official Theme CSS -->
    <style>
    /* ===== RENDZZ DARK THEME ===== */
    :root {
      --rendzz-bg: #0a0a0f;
      --rendzz-card: #1a1a2e;
      --rendzz-card-secondary: #16213e;
      --rendzz-surface: #0f3460;
      --rendzz-primary: #00adb5;
      --rendzz-secondary: #393e46;
      --rendzz-accent: #ff2e63;
      --rendzz-success: #00ffab;
      --rendzz-danger: #ff304f;
      --rendzz-warning: #ff9a00;
      --rendzz-info: #00d2ff;
      --rendzz-text-primary: #eeeeee;
      --rendzz-text-secondary: #aaaaaa;
      --rendzz-border: rgba(0, 173, 181, 0.3);
      --rendzz-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
      --rendzz-glow: 0 0 20px rgba(0, 173, 181, 0.3);
      --server-online: #30d158;
      --server-offline: #ff375f;
      --server-starting: #ff9f0a;
      --server-stopping: #ffd60a;
      --server-installing: #64d2ff;
    }

    /* Background */
    body:not(.in-file-manager) {
      background: linear-gradient(135deg, #0a0a0f 0%, #16213e 100%), url('https://files.catbox.moe/z32ox4.jpg') !important;
      background-size: cover !important;
      background-position: center !important;
      background-attachment: fixed !important;
      color: var(--rendzz-text-primary) !important;
      font-family: 'Segoe UI', 'Inter', system-ui, sans-serif !important;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }

    /* Neon glow effect */
    body:not(.in-file-manager)::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 20% 20%, rgba(0, 173, 181, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(255, 46, 99, 0.1) 0%, transparent 50%);
      pointer-events: none;
      z-index: -1;
    }

    /* ===== SERVER DASHBOARD STYLING ===== */
    /* Server Cards */
    .server-card,
    [class*="server-"],
    .bg-gray-600.rounded {
      background: linear-gradient(145deg, var(--rendzz-card), var(--rendzz-card-secondary)) !important;
      border: 1px solid var(--rendzz-border) !important;
      border-radius: 12px !important;
      box-shadow: var(--rendzz-shadow) !important;
      transition: all 0.3s ease !important;
      position: relative;
      overflow: hidden;
    }

    .server-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--rendzz-primary);
      transition: all 0.3s ease;
    }

    .server-card:hover {
      transform: translateY(-5px) !important;
      border-color: var(--rendzz-primary) !important;
      box-shadow: 0 12px 40px rgba(0, 173, 181, 0.3) !important;
    }

    .server-card:hover::before {
      background: linear-gradient(90deg, var(--rendzz-primary), var(--rendzz-accent)) !important;
    }

    /* Server Status Colors */
    .server-card[data-status="running"]::before {
      background: var(--server-online) !important;
    }
    
    .server-card[data-status="offline"]::before {
      background: var(--server-offline) !important;
    }
    
    .server-card[data-status="starting"]::before {
      background: var(--server-starting) !important;
      animation: pulse 1.5s infinite;
    }
    
    .server-card[data-status="stopping"]::before {
      background: var(--server-stopping) !important;
      animation: pulse 1.5s infinite;
    }
    
    .server-card[data-status="installing"]::before {
      background: var(--server-installing) !important;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* Server Status Badges */
    .bg-success, .status-online {
      background: linear-gradient(135deg, var(--server-online), #25c748) !important;
      color: white !important;
      border-radius: 20px !important;
      padding: 4px 12px !important;
      font-size: 12px !important;
      font-weight: 600 !important;
      display: inline-flex !important;
      align-items: center !important;
      gap: 6px !important;
    }

    .bg-danger, .status-offline {
      background: linear-gradient(135deg, var(--server-offline), #ff2d55) !important;
      color: white !important;
      border-radius: 20px !important;
      padding: 4px 12px !important;
      font-size: 12px !important;
      font-weight: 600 !important;
      display: inline-flex !important;
      align-items: center !important;
      gap: 6px !important;
    }

    .bg-warning, .status-starting {
      background: linear-gradient(135deg, var(--server-starting), #ff8a00) !important;
      color: white !important;
      border-radius: 20px !important;
      padding: 4px 12px !important;
      font-size: 12px !important;
      font-weight: 600 !important;
      display: inline-flex !important;
      align-items: center !important;
      gap: 6px !important;
      animation: pulse 1.5s infinite;
    }

    /* Empty Server State */
    .text-gray-400.text-center.py-12 {
      padding: 3rem 1rem !important;
      background: var(--rendzz-card) !important;
      border-radius: 12px !important;
      border: 2px dashed var(--rendzz-border) !important;
      margin: 2rem auto !important;
      max-width: 600px !important;
    }

    .text-gray-400.text-center.py-12 h3 {
      color: var(--rendzz-text-primary) !important;
      font-size: 24px !important;
      font-weight: 700 !important;
      margin-bottom: 1rem !important;
      background: linear-gradient(90deg, var(--rendzz-primary), var(--rendzz-accent)) !important;
      -webkit-background-clip: text !important;
      -webkit-text-fill-color: transparent !important;
    }

    .text-gray-400.text-center.py-12 p {
      color: var(--rendzz-text-secondary) !important;
      font-size: 16px !important;
      margin-bottom: 1.5rem !important;
    }

    /* Server Resource Usage */
    .server-resource {
      background: var(--rendzz-card-secondary) !important;
      border-radius: 8px !important;
      padding: 12px !important;
      margin: 8px 0 !important;
      border-left: 3px solid var(--rendzz-primary) !important;
    }

    .server-resource.cpu {
      border-left-color: var(--rendzz-primary) !important;
    }

    .server-resource.memory {
      border-left-color: var(--rendzz-success) !important;
    }

    .server-resource.disk {
      border-left-color: var(--rendzz-accent) !important;
    }

    .server-resource.network {
      border-left-color: var(--rendzz-info) !important;
    }

    /* ===== FOOTER COPYRIGHT ===== */
    footer .text-center,
    .text-gray-500,
    .text-gray-600 {
      color: var(--rendzz-text-secondary) !important;
      font-size: 14px !important;
    }

    footer .text-center::after {
      content: "RENDZZ Official Â© 2024" !important;
      display: block !important;
      margin-top: 4px !important;
      font-weight: 600 !important;
      color: var(--rendzz-primary) !important;
    }

    /* Replace Pterodactyl copyright */
    div:contains("Pterodactyl"),
    div:contains("Â© 2015"),
    div:contains("Â© 2015 - 2026") {
      visibility: hidden !important;
      position: relative !important;
    }

    div:contains("Pterodactyl")::after,
    div:contains("Â© 2015")::after,
    div:contains("Â© 2015 - 2026")::after {
      content: "RENDZZ Official" !important;
      visibility: visible !important;
      position: absolute !important;
      top: 0;
      left: 0;
      color: var(--rendzz-primary) !important;
      font-weight: 600 !important;
    }

    /* ===== NO SERVERS MESSAGE ===== */
    div:contains("There are no servers"),
    div:contains("no servers"),
    div:contains("associated with your account") {
      position: relative !important;
    }

    div:contains("There are no servers")::after,
    div:contains("no servers")::after,
    div:contains("associated with your account")::after {
      content: "SERVER LU GAADA ðŸ«¢" !important;
      display: block !important;
      font-size: 24px !important;
      font-weight: 700 !important;
      color: var(--rendzz-accent) !important;
      text-align: center !important;
      margin: 2rem 0 !important;
      padding: 2rem !important;
      background: var(--rendzz-card) !important;
      border-radius: 12px !important;
      border: 2px dashed var(--rendzz-border) !important;
      animation: bounce 2s infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    /* ===== BUTTONS ===== */
    button, .btn, [type="submit"] {
      background: linear-gradient(135deg, var(--rendzz-primary), #008b94) !important;
      color: white !important;
      border: none !important;
      border-radius: 8px !important;
      padding: 12px 24px !important;
      font-weight: 600 !important;
      cursor: pointer !important;
      transition: all 0.3s ease !important;
    }

    button:hover, .btn:hover {
      background: linear-gradient(135deg, #008b94, #00747a) !important;
      transform: translateY(-2px) !important;
      box-shadow: 0 6px 20px rgba(0, 173, 181, 0.3) !important;
    }

    /* ===== CARDS ===== */
    .bg-white, .bg-gray-100, .card, .panel {
      background: var(--rendzz-card) !important;
      border: 1px solid var(--rendzz-border) !important;
      border-radius: 12px !important;
      color: var(--rendzz-text-primary) !important;
      box-shadow: var(--rendzz-shadow) !important;
      transition: all 0.3s ease !important;
    }

    .bg-white:hover, .card:hover {
      border-color: var(--rendzz-primary) !important;
      box-shadow: 0 12px 40px rgba(0, 173, 181, 0.2) !important;
      transform: translateY(-2px) !important;
    }

    /* ===== FILE MANAGER EXCLUSION ===== */
    .elfinder * {
      all: revert !important;
    }
    </style>

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // Deteksi file manager
        const isInFileManager = () => {
          return document.querySelector('.elfinder') !== null || 
                 window.location.pathname.includes('/file-manager');
        };

        if (isInFileManager()) {
          document.body.classList.add('in-file-manager');
          return;
        }

        const username = @json(auth()->user()->name?? 'User');
        const isAdmin = @json(auth()->user() && auth()->user()->root_admin ?? false);
        
        // Create RENDZZ Welcome Message
        const message = document.createElement("div");
        message.innerHTML = `
          <div style="display: flex; align-items: center; gap: 16px;">
            <div style="
              width: 48px;
              height: 48px;
              background: linear-gradient(135deg, #00adb5, #ff2e63);
              border-radius: 12px;
              display: flex;
              align-items: center;
              justify-content: center;
              font-size: 20px;
              color: white;
              box-shadow: 0 8px 32px rgba(0, 173, 181, 0.3);
            ">
              <i class="fas fa-${isAdmin ? 'shield-alt' : 'server'}"></i>
            </div>
            <div>
              <div style="font-weight: 700; font-size: 16px;">
                Welcome back, <strong style="color: #00adb5;">${username}</strong>
              </div>
              <div style="font-size: 12px; opacity: 0.8; margin-top: 4px;">
                <i class="fas fa-user-shield" style="color: #ff2e63;"></i>
                ${isAdmin ? 'Administrator' : 'User'} â€¢ RENDZZ Official
              </div>
            </div>
          </div>
        `;
        
        Object.assign(message.style, {
          position: "fixed",
          bottom: "30px",
          right: "30px",
          background: "rgba(26, 26, 46, 0.95)",
          backdropFilter: "blur(20px)",
          color: "#eeeeee",
          padding: "20px 24px",
          borderRadius: "16px",
          fontFamily: "'Segoe UI', system-ui, sans-serif",
          fontSize: "14px",
          boxShadow: "0 10px 40px rgba(0,0,0,0.5), 0 0 20px rgba(0, 173, 181, 0.2)",
          border: "1px solid rgba(0, 173, 181, 0.3)",
          zIndex: "99999",
          opacity: "0",
          transform: "translateY(100px)",
          transition: "all 0.6s ease",
          maxWidth: "350px",
          cursor: "pointer",
        });

        document.body.appendChild(message);
        
        // Animate in
        setTimeout(() => {
          message.style.opacity = "1";
          message.style.transform = "translateY(0)";
        }, 800);
        
        // Auto-hide after 8 seconds
        setTimeout(() => {
          message.style.opacity = "0";
          message.style.transform = "translateY(100px)";
        }, 8000);
        
        setTimeout(() => {
          if (message.parentNode) {
            message.remove();
          }
        }, 9000);

        // Click to dismiss
        message.addEventListener("click", () => {
          message.style.opacity = "0";
          message.style.transform = "translateY(100px)";
          setTimeout(() => {
            if (message.parentNode) {
              message.remove();
            }
          }, 500);
        });

        // ===== UPDATE SERVER CARDS =====
        const updateServerCards = () => {
          // Add status indicators to server cards
          document.querySelectorAll('[class*="server-"], .bg-gray-600.rounded').forEach(card => {
            if (!card.closest('.elfinder')) {
              card.classList.add('server-card');
              
              // Detect server status
              const cardText = card.textContent.toLowerCase();
              if (cardText.includes('running') || cardText.includes('online')) {
                card.setAttribute('data-status', 'running');
              } else if (cardText.includes('offline') || cardText.includes('stopped')) {
                card.setAttribute('data-status', 'offline');
              } else if (cardText.includes('starting')) {
                card.setAttribute('data-status', 'starting');
              } else if (cardText.includes('stopping')) {
                card.setAttribute('data-status', 'stopping');
              } else if (cardText.includes('install')) {
                card.setAttribute('data-status', 'installing');
              }
            }
          });

          // Add resource usage styling
          document.querySelectorAll('.progress').forEach(progress => {
            if (!progress.closest('.elfinder')) {
              progress.parentElement.classList.add('server-resource');
              
              if (progress.textContent.toLowerCase().includes('cpu')) {
                progress.parentElement.classList.add('cpu');
              } else if (progress.textContent.toLowerCase().includes('memory') || progress.textContent.toLowerCase().includes('ram')) {
                progress.parentElement.classList.add('memory');
              } else if (progress.textContent.toLowerCase().includes('disk')) {
                progress.parentElement.classList.add('disk');
              } else if (progress.textContent.toLowerCase().includes('network')) {
                progress.parentElement.classList.add('network');
              }
            }
          });
        };

        // ===== REPLACE COPYRIGHT TEXT =====
        const replaceCopyright = () => {
          // Replace Pterodactyl copyright
          const walker = document.createTreeWalker(
            document.body,
            NodeFilter.SHOW_TEXT,
            null,
            false
          );

          let node;
          while (node = walker.nextNode()) {
            if (node.nodeType === 3) { // Text node
              const text = node.nodeValue;
              
              // Replace Pterodactyl copyright
              if (text.includes('PterodactylÂ®') || 
                  text.includes('Â© 2015 - 2026') || 
                  text.includes('Â© 2015')) {
                node.nodeValue = text
                  .replace(/PterodactylÂ®/g, 'RENDZZ Official')
                  .replace(/Â© 2015 - 2026/g, 'Â© 2024 RENDZZ Official')
                  .replace(/Â© 2015/g, 'Â© 2024');
              }
              
              // Replace "no servers" message
              if (text.includes('There are no servers associated with your account') ||
                  text.includes('no servers') && text.includes('associated with your account')) {
                const parent = node.parentElement;
                if (parent && !parent.querySelector('.rendzz-no-server')) {
                  const newDiv = document.createElement('div');
                  newDiv.className = 'rendzz-no-server';
                  newDiv.innerHTML = `
                    <div style="text-align: center; padding: 3rem;">
                      <i class="fas fa-server" style="font-size: 48px; color: #ff2e63; margin-bottom: 1rem;"></i>
                      <h3 style="font-size: 24px; font-weight: 700; color: #ff2e63; margin-bottom: 1rem;">
                        SERVER LU GAADA ðŸ«¢
                      </h3>
                      <p style="color: #aaaaaa; margin-bottom: 2rem;">
                        Belum punya server? Create server baru sekarang!
                      </p>
                      <button style="
                        background: linear-gradient(135deg, #00adb5, #008b94);
                        color: white;
                        border: none;
                        border-radius: 8px;
                        padding: 12px 24px;
                        font-weight: 600;
                        cursor: pointer;
                      ">
                        <i class="fas fa-plus"></i> Create Server
                      </button>
                    </div>
                  `;
                  
                  // Replace parent content
                  parent.innerHTML = '';
                  parent.appendChild(newDiv);
                  parent.style.background = 'var(--rendzz-card)';
                  parent.style.borderRadius = '12px';
                  parent.style.border = '2px dashed var(--rendzz-border)';
                  parent.style.padding = '2rem';
                }
              }
            }
          }
        };

        // Run updates
        setTimeout(() => {
          updateServerCards();
          replaceCopyright();
        }, 1000);

        // Auto refresh
        if (window.location.pathname === '/') {
          setInterval(() => {
            updateServerCards();
          }, 5000);
        }
      });
    </script>
@endsection
EOF

echo "âœ… Base template updated with RENDZZ theme"

# ===== 2. UPDATE DASHBOARD NO SERVER MESSAGE =====
log_info "Updating 'No Servers' message..."

# Create a custom view for empty server state
EMPTY_SERVER_VIEW="$PANEL_PATH/resources/views/templates/server/empty.blade.php"
if [ ! -d "$(dirname "$EMPTY_SERVER_VIEW")" ]; then
    mkdir -p "$(dirname "$EMPTY_SERVER_VIEW")"
fi

cat > "$EMPTY_SERVER_VIEW" << 'EOF'
<div class="flex flex-col items-center justify-center px-6 py-12">
    <div class="text-center max-w-md">
        <div class="mb-6">
            <i class="fas fa-server text-6xl text-[#ff2e63] mb-4"></i>
            <h3 class="text-3xl font-bold text-[#ff2e63] mb-2">
                SERVER LU GAADA ðŸ«¢
            </h3>
            <p class="text-gray-400 mb-6">
                Belum punya server? Yuk bikin server baru buat main game atau hosting website!
            </p>
        </div>
        
        <div class="space-y-4">
            <a href="/servers/create" 
               class="inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-[#00adb5] to-[#008b94] text-white font-semibold rounded-lg hover:opacity-90 transition-all duration-300 transform hover:-translate-y-1">
                <i class="fas fa-plus mr-2"></i>
                Create New Server
            </a>
            
            <div class="text-sm text-gray-500 mt-4">
                <i class="fas fa-info-circle mr-1"></i>
                Need help? Contact administrator untuk bantuan
            </div>
        </div>
    </div>
</div>
EOF

echo "âœ… Empty server view created"

# ===== 3. UPDATE ADMIN LAYOUT WITH RENDZZ BRANDING =====
ADMIN_ENHANCEMENTS="<style>
/* RENDZZ Admin Branding */
footer div.text-center,
footer .text-gray-500,
footer .text-gray-600 {
    color: #00adb5 !important;
    font-weight: 600 !important;
}

footer div.text-center::after {
    content: 'RENDZZ Official Â© 2024' !important;
    display: block !important;
    margin-top: 4px !important;
}

/* Admin Dashboard Enhancements */
.admin-header h1 {
    background: linear-gradient(90deg, #00adb5, #ff2e63) !important;
    -webkit-background-clip: text !important;
    -webkit-text-fill-color: transparent !important;
    font-weight: 800 !important;
}

.admin-stat-card {
    background: linear-gradient(145deg, #1a1a2e, #16213e) !important;
    border: 1px solid rgba(0, 173, 181, 0.3) !important;
    border-radius: 12px !important;
    padding: 1.5rem !important;
    transition: all 0.3s ease !important;
}

.admin-stat-card:hover {
    transform: translateY(-5px) !important;
    border-color: #00adb5 !important;
    box-shadow: 0 12px 30px rgba(0, 173, 181, 0.2) !important;
}

/* Server Status Colors in Admin */
.bg-success-soft {
    background: rgba(48, 209, 88, 0.1) !important;
    color: #30d158 !important;
    border: 1px solid rgba(48, 209, 88, 0.3) !important;
}

.bg-danger-soft {
    background: rgba(255, 55, 95, 0.1) !important;
    color: #ff375f !important;
    border: 1px solid rgba(255, 55, 95, 0.3) !important;
}

.bg-warning-soft {
    background: rgba(255, 159, 10, 0.1) !important;
    color: #ff9f0a !important;
    border: 1px solid rgba(255, 159, 10, 0.3) !important;
}
</style>

<script>
// Replace Pterodactyl branding in admin panel
document.addEventListener('DOMContentLoaded', function() {
    // Replace copyright text
    const replaceText = (element, search, replace) => {
        if (element.textContent.includes(search)) {
            element.textContent = element.textContent.replace(search, replace);
        }
    };
    
    // Replace in all text nodes
    const walker = document.createTreeWalker(
        document.body,
        NodeFilter.SHOW_TEXT,
        null,
        false
    );
    
    let node;
    while (node = walker.nextNode()) {
        replaceText(node, 'PterodactylÂ®', 'RENDZZ Official');
        replaceText(node, 'Â© 2015 - 2026', 'Â© 2024 RENDZZ Official');
        replaceText(node, 'Pterodactyl Panel', 'RENDZZ Panel');
    }
    
    // Add RENDZZ badge to admin header
    const header = document.querySelector('header');
    if (header && !header.querySelector('.rendzz-badge')) {
        const badge = document.createElement('div');
        badge.className = 'rendzz-badge';
        badge.innerHTML = \`
            <div style="
                display: inline-flex;
                align-items: center;
                gap: 6px;
                background: linear-gradient(90deg, rgba(0, 173, 181, 0.2), rgba(255, 46, 99, 0.2));
                padding: 6px 12px;
                border-radius: 20px;
                border: 1px solid rgba(0, 173, 181, 0.3);
                font-size: 12px;
                font-weight: 600;
                color: #00adb5;
            ">
                <i class="fas fa-shield-alt"></i>
                RENDZZ Official
            </div>
        \`;
        header.appendChild(badge);
    }
});
</script>"

# Apply to admin layout
if [ -f "$ADMIN_LAYOUT" ]; then
    sed -i "/<\/head>/i $ADMIN_ENHANCEMENTS" "$ADMIN_LAYOUT"
    echo "âœ… Admin layout updated with RENDZZ branding"
fi

# ===== 4. UPDATE AUTH LAYOUT =====
AUTH_CSS="<style>
/* RENDZZ Login Page */
body:not(.in-file-manager) #app > div {
    background: linear-gradient(135deg, #0a0a0f 0%, #16213e 100%), url('${BG_IMAGE}') !important;
    background-size: cover !important;
    background-position: center !important;
    background-attachment: fixed !important;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Login Card */
body:not(.in-file-manager) .bg-white,
body:not(.in-file-manager) .bg-gray-100 {
    background: rgba(26, 26, 46, 0.95) !important;
    backdrop-filter: blur(20px) !important;
    border: 1px solid rgba(0, 173, 181, 0.3) !important;
    border-radius: 16px !important;
    padding: 2.5rem !important;
    max-width: 400px !important;
    width: 90% !important;
    margin: 2rem !important;
    box-shadow: 0 20px 60px rgba(0,0,0,0.5) !important;
}

/* Login Title */
body:not(.in-file-manager) .text-2xl,
body:not(.in-file-manager) .text-3xl {
    background: linear-gradient(90deg, #00adb5, #ff2e63) !important;
    -webkit-background-clip: text !important;
    -webkit-text-fill-color: transparent !important;
    font-weight: 800 !important;
    text-align: center !important;
    margin-bottom: 2rem !important;
}

/* Login Button */
body:not(.in-file-manager) button[type=\"submit\"] {
    width: 100% !important;
    background: linear-gradient(135deg, #00adb5, #008b94) !important;
    color: white !important;
    border: none !important;
    border-radius: 8px !important;
    padding: 14px !important;
    font-weight: 600 !important;
    transition: all 0.3s ease !important;
}

body:not(.in-file-manager) button[type=\"submit\"]:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 6px 20px rgba(0, 173, 181, 0.3) !important;
}

/* Copyright */
body:not(.in-file-manager) .text-center.text-xs.text-gray-500::after {
    content: 'RENDZZ Official Â© 2024' !important;
    color: #00adb5 !important;
    font-weight: 600 !important;
    font-size: 13px !important;
    margin-top: 2rem !important;
    display: block;
}
</style>"

sed -i "/<\/head>/i $AUTH_CSS" "$AUTH_LAYOUT"
echo "âœ… Auth layout updated"

# ===== 5. UPDATE APP LAYOUT =====
APP_UPDATES="<style>
/* Server status colors */
.status-badge {
    padding: 4px 12px !important;
    border-radius: 20px !important;
    font-size: 12px !important;
    font-weight: 600 !important;
    display: inline-flex !important;
    align-items: center !important;
    gap: 6px !important;
}

.status-badge.online {
    background: rgba(48, 209, 88, 0.1) !important;
    color: #30d158 !important;
    border: 1px solid rgba(48, 209, 88, 0.3) !important;
}

.status-badge.offline {
    background: rgba(255, 55, 95, 0.1) !important;
    color: #ff375f !important;
    border: 1px solid rgba(255, 55, 95, 0.3) !important;
}

/* Empty state */
.empty-state {
    text-align: center !important;
    padding: 3rem 1rem !important;
    background: #1a1a2e !important;
    border-radius: 12px !important;
    border: 2px dashed rgba(0, 173, 181, 0.3) !important;
    margin: 2rem auto !important;
}

.empty-state h3 {
    color: #ff2e63 !important;
    font-size: 24px !important;
    font-weight: 700 !important;
    margin-bottom: 1rem !important;
}

/* Footer copyright */
footer div:contains('Â©') {
    color: #00adb5 !important;
    font-weight: 600 !important;
}
</style>

<script>
// Update server status badges
document.addEventListener('DOMContentLoaded', function() {
    // Update status badges
    document.querySelectorAll('.bg-success, .status-online').forEach(el => {
        el.className = 'status-badge online';
        el.innerHTML = '<i class="fas fa-circle"></i> Online';
    });
    
    document.querySelectorAll('.bg-danger, .status-offline').forEach(el => {
        el.className = 'status-badge offline';
        el.innerHTML = '<i class="fas fa-circle"></i> Offline';
    });
    
    // Replace copyright
    const walker = document.createTreeWalker(
        document.body,
        NodeFilter.SHOW_TEXT,
        null,
        false
    );
    
    let node;
    while (node = walker.nextNode()) {
        if (node.nodeValue.includes('Pterodactyl') || 
            node.nodeValue.includes('Â© 2015')) {
            node.nodeValue = node.nodeValue
                .replace(/PterodactylÂ®/g, 'RENDZZ Official')
                .replace(/Â© 2015 - 2026/g, 'Â© 2024 RENDZZ Official');
        }
    }
});
</script>"

sed -i "/<\/head>/i $APP_UPDATES" "$APP_LAYOUT"
echo "âœ… App layout updated"

# ===== 6. UPDATE JAVASCRIPT FILES =====
log_info "Updating JavaScript files for copyright replacement..."

# Find and replace copyright in JS files
find "$PANEL_PATH" -name "*.js" -type f | while read -r js_file; do
    if grep -q "Pterodactyl\|Â© 2015" "$js_file" 2>/dev/null; then
        sed -i 's/PterodactylÂ®/RENDZZ Official/g' "$js_file"
        sed -i 's/Â© 2015 - 2026/Â© 2024 RENDZZ Official/g' "$js_file"
        sed -i 's/Pterodactyl Panel/RENDZZ Panel/g' "$js_file"
        echo "Updated: $(basename "$js_file")"
    fi
done

# ===== 7. CLEAR CACHE =====
log_info "Clearing cache..."
cd "$PANEL_PATH" || exit
php artisan view:clear > /dev/null 2>&1
php artisan cache:clear > /dev/null 2>&1
php artisan config:clear > /dev/null 2>&1

echo ""
echo "========================================="
echo "ðŸš€ RENDZZ OFFICIAL THEME UPDATED!"
echo "========================================="
echo "ðŸŽ¨ CHANGES APPLIED:"
echo "  âœ“ Server cards with status colors"
echo "  âœ“ Pterodactyl â†’ RENDZZ Official branding"
echo "  âœ“ 'No servers' message â†’ 'SERVER LU GAADA ðŸ«¢'"
echo "  âœ“ Custom empty server state"
echo "  âœ“ Admin panel RENDZZ branding"
echo "  âœ“ Login page updates"
echo "  âœ“ Server status color coding"
echo "  âœ“ Copyright replaced everywhere"
echo ""
echo "ðŸŽ¯ SERVER STATUS COLORS:"
echo "  â€¢ Online: Green (#30d158)"
echo "  â€¢ Offline: Red (#ff375f)"
echo "  â€¢ Starting: Orange (#ff9f0a)"
echo "  â€¢ Installing: Blue (#64d2ff)"
echo ""
echo "ðŸ”„ Refresh your browser to see changes!"
echo "========================================="
