#!/bin/bash

echo "üöÄ Ganti tulisan & background Pterodactyl..."

PANEL_PATH="/var/www/pterodactyl"
LOGIN_VIEW="$PANEL_PATH/resources/views/auth/login.blade.php"
AUTH_LAYOUT="$PANEL_PATH/resources/views/layouts/auth.blade.php"

IMAGE_URL="https://files.catbox.moe/j8860d.jpg"
NEW_TEXT="RENSTR!"
TIMESTAMP=$(date -u +"%Y-%m-%d-%H-%M-%S")

# ===== BACKUP =====
cp "$LOGIN_VIEW" "$LOGIN_VIEW.bak_$TIMESTAMP"
cp "$AUTH_LAYOUT" "$AUTH_LAYOUT.bak_$TIMESTAMP"
echo "üì¶ Backup aman"

# ===== GANTI TULISAN =====
sed -i 's/Pterodactyl Software/'"$NEW_TEXT"'/g' "$LOGIN_VIEW"
echo "‚úèÔ∏è Tulisan diganti jadi $NEW_TEXT"

# ===== OVERRIDE BACKGROUND ORIGINAL =====
sed -i '/<\/head>/i \
<style>\n\
/* === FORCE BACKGROUND LOGIN (RENSTR) === */\n\
html, body {\n\
  background: url("'"$IMAGE_URL"'") no-repeat center center fixed !important;\n\
  background-size: cover !important;\n\
}\n\
.bg-neutral-900,\n\
.bg-neutral-800,\n\
.bg-gray-900,\n\
.bg-gray-800 {\n\
  background-color: rgba(0,0,0,0.65) !important;\n\
}\n\
</style>\n' "$AUTH_LAYOUT"

# ===== PERMISSION =====
chown -R www-data:www-data "$PANEL_PATH"

# ===== CLEAR CACHE =====
cd "$PANEL_PATH" || exit
php artisan view:clear
php artisan cache:clear

echo "‚úÖ SELESAI!"
echo "üñºÔ∏è Background: Custom Foto"
echo "‚úèÔ∏è Text: RENSTR!"
